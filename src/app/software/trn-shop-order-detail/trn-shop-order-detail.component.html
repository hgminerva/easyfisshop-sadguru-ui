<div [hidden]="isLoadingSpinnerHidden">
  <br /><br /><br />
  <mat-spinner style="margin: auto;"></mat-spinner>
</div>
<div [hidden]="isContentHidden">
  <div class="card card-default">
    <div class="card-header">
      <table border="0" style="width: 100%; border: none;">
        <tr>
          <td>
            <button class="btn btn-primary" [hidden]="isSaveButtonHide" style="margin-right: 5px;" [disabled]="isLocked"
              (click)="btnSaveShopOrderClick()" id="btnSaveShopOrder">
              <fa name="save"></fa> Save
            </button>
          </td>
          <td style="text-align: right;">
            <button class="btn btn-primary" [hidden]="isLockButtonHide" style="margin-right: 5px;" [disabled]="isLocked"
              (click)="btnLockShopOrderClick()" id="btnLockShopOrder">
              <fa name="lock"></fa> Lock
            </button>
            <button class="btn btn-primary" [hidden]="isUnlockButtonHide" style="margin-right: 5px;" [disabled]="isLocked ? false : true"
              (click)="btnUnlockShopOrderClick()" id="btnUnlockShopOrder">
              <fa name="unlock"></fa> Unlock
            </button>
            <button class="btn btn-danger" routerLink="/software/trn-shop-order-list">
              <fa name="close"></fa> Close
            </button>
          </td>
        </tr>
      </table>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-lg-6">
          <div class="form-group row">
            <label for="" class="col-sm-4 col-form-label form-group-label">Branch</label>
            <div class="col-sm-8">
              <input type="text" class="form-control" [(ngModel)]="trnShopOrderDetailModel.Branch" id="" placeholder="Branch..."
                disabled>
            </div>
            <br /><br />
            <label for="" class="col-sm-4 col-form-label form-group-label">Order No.</label>
            <div class="col-sm-8">
              <input type="text" class="form-control" [(ngModel)]="trnShopOrderDetailModel.SPNumber" id="" placeholder="SP Number..."
                [disabled]="isLocked">
            </div>
            <br /><br />
            <label for="" class="col-sm-4 col-form-label form-group-label">Date</label>
            <div class="col-sm-8">
              <wj-input-date #cboShopOrderDate [disabled]="isLocked" [(ngModel)]="trnShopOrderDetailModel.SPDate"
                format="MM-dd-yyyy" style="width: 100%; padding: 3px;">
              </wj-input-date>
            </div>
            <br /><br />
            <label for="" class="col-sm-4 col-form-label form-group-label">Item</label>
            <div class="col-sm-8">
              <wj-combo-box #cboShopOrderItem [disabled]="isLocked" [(ngModel)]="trnShopOrderDetailModel.ItemId"
                [itemsSource]="cboItemObservableArray" [isEditable]="false" [isRequired]="true" [displayMemberPath]="'Item'"
                [selectedValuePath]="'Id'" style="width: 100%; padding: 3px;">
              </wj-combo-box>
            </div>
            <br /><br />
            <label for="" class="col-sm-4 col-form-label form-group-label">Quantity</label>
            <div class="col-sm-8">
              <wj-input-number [isRequired]="false" [disabled]="isLocked" [(ngModel)]="trnShopOrderDetailModel.Quantity"
                style="width: 100%; padding: 3px;" [placeholder]="'0.00'">
              </wj-input-number>
            </div>
            <br /><br />
            <label for="" class="col-sm-4 col-form-label form-group-label">Amount</label>
            <div class="col-sm-8">
              <wj-input-number [isRequired]="false" [disabled]="isLocked" [(ngModel)]="trnShopOrderDetailModel.Amount"
                style="width: 100%; padding: 3px;" [placeholder]="'0.00'">
              </wj-input-number>
            </div>
            <br /><br />
            <label for="" class="col-sm-4 col-form-label form-group-label">Group</label>
            <div class="col-sm-8">
              <wj-combo-box #cboShopOrderShopGroup [disabled]="isLocked" [(ngModel)]="trnShopOrderDetailModel.ShopGroupId"
                [itemsSource]="cboShopGroupObservableArray" [isEditable]="false" [isRequired]="true"
                [displayMemberPath]="'ShopGroup'" [selectedValuePath]="'Id'" style="width: 100%; padding: 3px;">
              </wj-combo-box>
            </div>
            <br /><br />
          </div>
        </div>
        <div class="col-lg-6">
          <div class="form-group row">
            <label for="" class="col-sm-4 col-form-label form-group-label">Particulars</label>
            <div class="col-sm-8">
              <textarea type="text" class="form-control" style="resize: none" [disabled]="isLocked" [(ngModel)]="trnShopOrderDetailModel.Particulars"
                id="" placeholder="Particulars..." rows="5"></textarea>
            </div>
            <br /><br /><br /><br /><br /><br />
            <label for="" class="col-sm-4 col-form-label form-group-label">Status</label>
            <div class="col-sm-8">
              <wj-combo-box #cboShopOrderShopOrderStatus [disabled]="isLocked" [(ngModel)]="trnShopOrderDetailModel.ShopOrderStatusId"
                [itemsSource]="cboShopOrderStatusObservableArray" [isEditable]="false" [isRequired]="true"
                [displayMemberPath]="'ShopOrderStatus'" [selectedValuePath]="'Id'" style="width: 100%; padding: 3px;">
              </wj-combo-box>
            </div>
            <br /><br />
            <label for="" class="col-sm-4 col-form-label form-group-label">Status Date</label>
            <div class="col-sm-8">
              <wj-input-date #cboShopOrderDate [disabled]="isLocked" [(ngModel)]="trnShopOrderDetailModel.ShopOrderStatusDate"
                format="MM-dd-yyyy" style="width: 100%; padding: 3px;">
              </wj-input-date>
            </div>
            <br /><br />
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card card-default" style="margin-top: 10px;">

    <!-- Header -->
    <div class="card-header">
      <table border="0" style="width: 100%; border: none;">
        <tr>
          <td>
            <div class="input-group">
              <div class="input-group-prepend">
                <div class="input-group-text">
                  <b>
                    <fa name="table"></fa>
                  </b>
                </div>
              </div>
              <wj-combo-box #cboNumberOfRows [itemsSource]="cboShowNumberOfRows" [isEditable]="false" [isRequired]="true"
                [displayMemberPath]="'rowString'" [selectedValuePath]="'rowNumber'" (selectedIndexChanged)="cboShowNumberOfRowsOnSelectedIndexChanged(cboNumberOfRows.selectedValue)"
                style="width: 140px;">
              </wj-combo-box>
            </div>
          </td>
          <td style="text-align: right;">
            <button class="btn btn-primary" [hidden]="isAddButtonHide" [disabled]="isLocked" (click)="btnOpenShopOrderLineModalClick(shopOrderLineModalTemplate, true)"
              style="margin-right: 5px;" id="btnOpenShopOrderLineModal">
              <fa name="plus"></fa> Add Activity
            </button>
          </td>
        </tr>
      </table>
    </div>

    <!-- Flexgrid -->
    <div class="card-body">
      <mat-progress-bar [hidden]="isProgressBarHidden" [color]="'primary'" [mode]="'indeterminate'"></mat-progress-bar>
      <wj-flex-grid #listShopOrderLineFlexGrid [itemsSource]="listShopOrderLineCollectionView" [selectionMode]="3"
        [frozenColumns]="2">
        <wj-flex-grid-filter></wj-flex-grid-filter>
        <wj-flex-grid-column *ngIf="isShowEditColumn" [header]="Edit" [isReadOnly]="true" [width]="80">
          <ng-template wjFlexGridCellTemplate [cellType]="'Cell'">
            <button [hidden]="isEditButtonHide" type="button" class="btn btn-primary btn-block btn-xs" [disabled]="isLocked"
              (click)="btnOpenShopOrderLineModalClick(shopOrderLineModalTemplate, false)" id="btnOpenShopOrderLineModal">
              <fa name="edit"></fa> Edit
            </button>
          </ng-template>
        </wj-flex-grid-column>
        <wj-flex-grid-column *ngIf="isShowDeleteColumn" [header]="Delete" [isReadOnly]="true" [width]="90">
          <ng-template wjFlexGridCellTemplate [cellType]="'Cell'">
            <button [hidden]="isDeleteButtonHide" type="button" class="btn btn-danger btn-block btn-xs" [disabled]="isLocked"
              (click)="btnDeleteShopOrderLineClick(shopOrderLineDeleteModalTemplate)" id="btnDeleteShopOrderLine">
              <fa name="trash"></fa> Delete
            </button>
          </ng-template>
        </wj-flex-grid-column>
        <wj-flex-grid-column [header]="'Date'" [binding]="'ActivityDate'" [isReadOnly]="true" [width]="'1*'"></wj-flex-grid-column>
        <wj-flex-grid-column [header]="'Activity'" [binding]="'Activity'" [isReadOnly]="true" [width]="'4*'"></wj-flex-grid-column>
        <wj-flex-grid-column [header]="'User'" [binding]="'User'" [isReadOnly]="true" [width]="'2*'"></wj-flex-grid-column>
      </wj-flex-grid>
    </div>

    <!-- Navigation flexgrid -->
    <div class="card-footer">
      <div class="col-sm-12 btn-group" style="padding: 5px 0px 5px 0px;">
        <button type="button" class="btn btn-secondary" (click)="listShopOrderLineCollectionView.moveToFirstPage()">
          <fa name="fast-backward"></fa>
        </button>
        <button type="button" class="btn btn-secondary" (click)="listShopOrderLineCollectionView.moveToPreviousPage()">
          <fa name="step-backward"></fa>
        </button>
        <button type="button" class="btn btn-secondary" disabled style="width:100px">
          {{ listShopOrderLineCollectionView.pageIndex + 1 }} / {{ listShopOrderLineCollectionView.pageCount }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="listShopOrderLineCollectionView.moveToNextPage()">
          <fa name="step-forward"></fa>
        </button>
        <button type="button" class="btn btn-secondary" (click)="listShopOrderLineCollectionView.moveToLastPage()">
          <fa name="fast-forward"></fa>
        </button>
      </div>
    </div>
  </div>

  <!-- User stamp -->
  <div class="card card-default" style="margin-top: 10px;">
    <div class="card-header">
      User stamp
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <p>Created by:</p>
          <div style="padding-left: 10px;">
            <fa name="key"></fa>&nbsp;
            <label id="createdBy">
              {{ trnShopOrderDetailModel.CreatedBy }}
            </label>
            <br />
            <small>
              <fa name="calendar"></fa>&nbsp;&nbsp;
              <span id="createdDate">
                {{ trnShopOrderDetailModel.CreatedDateTime }}
              </span>
            </small>
          </div>
          <br />
        </div>
        <div class="col-md-6">
          <p>Updated by:</p>
          <div style="padding-left: 10px;">
            <fa name="key"></fa>&nbsp;
            <label id="updatedBy">
              {{ trnShopOrderDetailModel.UpdatedBy }}
            </label>
            <br />
            <small>
              <fa name="calendar"></fa>&nbsp;&nbsp;
              <span id="updatedDate">
                {{ trnShopOrderDetailModel.UpdatedDateTime }}
              </span>
            </small>
          </div>
          <br />
        </div>
      </div>
    </div>
  </div>

  <!-- Shop order line modal -->
  <ng-template #shopOrderLineModalTemplate>
    <div class="modal-header">
      <h5 class="modal-title" id="shopOrderLineModalLabel">{{ shopOrderLineModalTitle }}</h5>
      <button type="button" class="close" (click)="shopOrderLineModalRef.hide()" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="form-group row">
        <label for="" class="col-sm-3 col-form-label form-group-label">Date</label>
        <div class="col-sm-9">
          <wj-input-date #cboShopOrderLineActivityDate [disabled]="isShopOrderLineActivityDateDisabled" [(ngModel)]="trnShopOrderLineModel.ActivityDate"
            format="MM-dd-yyyy" style="width: 300px; padding: 3px;">
          </wj-input-date>
        </div>
        <br /><br />
        <label for="" class="col-sm-3 col-form-label form-group-label">Activity</label>
        <div class="col-sm-9">
          <textarea type="text" class="form-control" [(ngModel)]="trnShopOrderLineModel.Activity" style="resize: none"
            id="inpActivity" placeholder="Activity..." rows="7"></textarea>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-primary" (click)="btnSaveShopOrderLineClick()" id="btnSaveShopOrderLine">
        <fa name="save"></fa> Save
      </button>
      <button type="button" class="btn btn-danger" (click)="shopOrderLineModalRef.hide()" id="btnCloseShopOrderLineModal">
        <fa name="close"></fa> Close
      </button>
    </div>
  </ng-template>

  <!-- Shop order line delete modal -->
  <ng-template #shopOrderLineDeleteModalTemplate>
    <div class="modal-header">
      <h4 class="modal-title">
        Delete
      </h4>
    </div>
    <div class="modal-body">
      Are you sure you want to delete this line activity?
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-danger" style="margin-right: 5px;" (click)="btnConfirmDeleteShopOrderLineClick()"
        id="btnConfirmDeleteShopOrderLine">
        <fa name="trash"></fa> Delete
      </button>
      <button type="button" class="btn" (click)="shopOrderLineDeleteModalRef.hide()" id="btnCloseConfirmDeleteShopOrderLineModal">
        <fa name="close"></fa> Cancel
      </button>
    </div>
  </ng-template>
</div>